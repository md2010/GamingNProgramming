<div *ngIf="loaded">
    <div class="row" *ngIf="task.isCoding">
            <div class="col-md-4">
                    <p class="spc-left" *ngIf="task.isTimeMeasured">Zadatku se mjeri vrijeme. Pokreni odbrojavanje klikom na gumb.</p>
                    <button type="button" *ngIf="task.isTimeMeasured" [disabled]="true" class="btn btn-success spc-left">Pokreni odbrojavanje</button>
                    <h3 class="spc-left">{{task.title}}</h3><hr>
                    <div class="spc-left">{{task.description}}</div>
            </div>
            <div class="col-md-8">
                    <nu-monaco-editor 
                    [(ngModel)]="value" 
                    [options]="editorOptions" 
                    [model]="model"
                    [disabled]="true"
                    [height]="'470'">
                    </nu-monaco-editor>
            </div>
            <hr>
    </div>
    
    <div *ngIf="loading">
            <app-spinner-component></app-spinner-component>
    </div>
    <div *ngIf="showToast">
        <app-toast-component [message]="message" (timeElapsedEvent)="onToastMessageElapsed()"></app-toast-component>
    </div>
    
    <div class="row" *ngIf="task.isCoding">
            <div>                   
                    <div class="spc-button spc-top col-12" *ngIf="error" >
                        <textarea readonly>{{compileResult}}</textarea>
                    </div>
                    <div *ngIf="!error" class="spc-button spc-top row">
                        <div class="col-8 overflow-auto" style="height: 200px;">
                        <table class="table table-striped">
                                <thead>
                                        <tr>
                                                <th scope="col">Ulaz</th>
                                                <th scope="col">Izlaz</th>
                                                <th scope="col">Očekivani izlaz</th>
                                        </tr>                                       
                                </thead>
                                <tbody>
                                        <tr *ngFor="let r of this.submitCodeResult"  [ngClass]="{ 'wrong' : r.result !== r.expectedOutput}">
                                                <td>{{r.inputs}}</td>
                                                <td>{{r.result}}</td>
                                                <td>{{r.expectedOutput}}</td>
                                        </tr>
                                </tbody>                                
                        </table>
                    </div>
                    <div class="col-2">
                        <p>Osvojeno bodova: 
                                <strong *ngIf="role === 'Student'">{{playersTask!.scoredPoints}}/{{task.points}}</strong>
                                <strong *ngIf="role !== 'Student'">
                                    <input style="width:60px" class="form-control-sm" name="point" type="number" value="{{playersTask!.scoredPoints}}" [(ngModel)]="newPoints"> / {{task.points}}                                           
                                </strong>
                        </p>
                        <button *ngIf="role !== 'Student'" type="button" class="btn btn-success" (click)="updatePoints()">Spremi izmjenu</button> 
                        <p>Vrijeme izvođenja: <strong>{{playersTask!.executionTime}} ms</strong></p>
                    </div>
                </div>
            </div>
    </div>
    
    <div class="row" *ngIf="!task.isCoding">
            <div class="col-md-4">
                    <p class="spc-left" *ngIf="task.isTimeMeasured">Zadatku se mjeri vrijeme. Pokreni odbrojavanje klikom na gumb.</p>
                    <button type="button" *ngIf="task.isTimeMeasured" [disabled]="true" class="btn btn-success spc-left">Pokreni odbrojavanje</button>
                    <h3 class="spc-left">{{task.title}}</h3>
            </div>
    </div>
    <div class="row" *ngIf="!task.isCoding">
            <div class="col-md-4"></div>
            <div class="col-md-4">
                <div class="fw-bold">{{description}}</div>
                    <div *ngIf="code.length > 0">
                        <nu-monaco-editor 
                        [(ngModel)]="code" 
                        [options]="editorOptions" 
                        [model]="model"
                        [disabled]="true"
                        [height]="'250'">
                        </nu-monaco-editor>
                </div>
                    <div *ngIf="!task.isMultiSelect">
                            <mat-radio-group aria-label="Select an option" name="correctAnswer"  [disabled]="true" class="tp-radio-group" [(ngModel)]="checkedAnswer">
                                <mat-radio-button *ngFor="let c of task.answers; let ind = index;" [value]="c.offeredAnswer" class="tp-radio-button"> 
                                    <p class="p-answer">{{c.offeredAnswer}}</p>                            
                                </mat-radio-button>                
                            </mat-radio-group>                         
                        </div> 
                        <div *ngIf="task.isMultiSelect">
                            <ul style="list-style-type: none;">
                                <li *ngFor="let c of offeredAnswers; let ind = index;">
                                    <mat-checkbox  [value]="c.value" name="checkbox{{ind}}" [disabled]="true" [(ngModel)]="c.checked">
                                            <p class="p-answer">{{c.value}} </p>                                
                                    </mat-checkbox> 
                                </li> 
                            </ul>                                       
                        </div>
            </div>
            <div class="col-md-4"></div>
    </div>
    <hr>
    <div class="row" *ngIf="!task.isCoding">
            <div class="col-4 spc-left spc-button">        
                    <div class="spc-button spc-bottom" *ngIf="loaded">
                            <br>  
                            <div *ngIf="playersTask!.scoredPoints! > 0">
                                    <p>Odgovor je <strong> {{playersTask!.scoredPoints === task.points ? 'točan!' : 'djelomično točan.'}}</strong></p>
                                    <p>Osvojeno bodova: 
                                        <strong *ngIf="role === 'Student'">{{playersTask!.scoredPoints}}/{{task.points}}</strong>
                                        <strong *ngIf="role !== 'Student'">
                                            <input class="form-control-sm" style="width:60px" name="point" type="number" value="{{playersTask!.scoredPoints}}" [(ngModel)]="newPoints"> / {{task.points}}                                           
                                        </strong>
                                    </p>
                                    <p *ngIf="points !== task.points">Točan odgovor: 
                                        <strong *ngIf="!task.isMultiSelect">{{correctAnswer}}</strong>
                                        <strong *ngIf="task.isMultiSelect">{{correctAnswers}}</strong>
                                    </p>
                                    <button *ngIf="role !== 'Student'" type="button" class="btn btn-success" (click)="updatePoints()">Spremi izmjenu</button> 
                            </div>
                            <div *ngIf="!(playersTask!.scoredPoints > 0)" class="col-4">
                                    <p>Odgovor je <strong>netočan.</strong></p>
                                    <p>Osvojeno bodova: 
                                        <strong *ngIf="role === 'Student'">{{playersTask!.scoredPoints}}/{{task.points}}</strong>
                                        <strong *ngIf="role !== 'Student'">
                                            <input style="width:60px" class="form-control-sm" name="point" type="number" value="{{playersTask!.scoredPoints}}" [(ngModel)]="newPoints"> / {{task.points}}                                           
                                        </strong>
                                    </p>
                                    <p>Točan odgovor: 
                                            <strong *ngIf="!task.isMultiSelect">{{correctAnswer}}</strong>
                                            <strong *ngIf="task.isMultiSelect">{{correctAnswers}}</strong>
                                    </p>
                            </div>                   
                    </div>               
            </div>
    </div>
    <div class="row">
            <div class="col-2 to-bottom">
                    <button type="button" class="btn btn-success" (click)="goBack()">Natrag na zadatke</button> 
            </div>            
    </div>
</div>

<ng-template #notification let-data>
        <h2 matDialogTitle>Obavijest</h2>
        <mat-dialog-content>
           <p>{{data}}</p>
        </mat-dialog-content>
        <mat-dialog-actions align="end">
          <button class="btn btn-primary" mat-button matDialogClose>Zatvori</button>
        </mat-dialog-actions>
</ng-template>

    